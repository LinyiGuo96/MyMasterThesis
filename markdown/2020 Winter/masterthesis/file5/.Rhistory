legend('topright',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n',cex=.8)
title(main='lag1')
par(mfrow=c(1,1))
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-65,0), ylab='',col=4, lwd=2)
legend(x=2008, y=0,c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n',cex=.8,inset=0.01)
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-65,0), ylab='', col=4, lwd=2)
legend('topright',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n',cex=.8)
title(main='lag1')
par(mfrow=c(1,1))
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-65,0), ylab='',col=4, lwd=2)
legend(x=2010, y=0,c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n',cex=.8,inset=0.01)
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-65,0), ylab='', col=4, lwd=2)
legend('topright',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n',cex=.8)
title(main='lag1')
par(mfrow=c(1,1))
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-65,0), ylab='',col=4, lwd=2)
legend(x=2010, y=0,c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-65,0), ylab='', col=4, lwd=2)
legend(x=140, y=0, c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-65,0), ylab='',col=4, lwd=2)
legend(x=2010, y=0,c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-65,0), ylab='', col=4, lwd=2)
legend(x=110, y=0, c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
dataeg <- simlist[[173]]
dataeg_x11 <- seas(dataeg, x11='')
dataeg_ssm0 <- SSModel(dataeg ~ SSMtrend(1, Q=list(NA)) + SSMseasonal(12, sea.type = 'dummy', Q=NA), H=NA)
dataeg_fit0 <- fitSSM(dataeg_ssm0, inits = c(1,1,1))
dataeg_kfs0 <- KFS(dataeg_fit0$model)
plot(series(dataeg_x11, "d12"),ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-65,0), ylab='',col=4, lwd=2)
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-65,0), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal[-180],type='l', ylim=c(-65,0), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-65,0), ylab='', col=4, lwd=2)
plot(series(dataeg_x11, "d12"), ylab='', lwd=2)
plot(series(dataeg_x11, "d12"),ylim=c(-5,40), ylab='', lwd=2)
plot(series(dataeg_x11, "d12"),ylim=c(-5,40), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-5,40), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-5,40), ylab='',col=4, lwd=2)
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-5,40), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal[-180],type='l', ylim=c(-5,40), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-5,40), ylab='', col=4, lwd=2)
library(doParallel)
system.time({
cl <- detectCores()
cl <- makeCluster(cl)
clusterExport(cl, c("loss5"))
lossmat5  <- foreach (i = 1:200, .combine = "rbind", .packages = c("KFAS","seasonal")) %:%
foreach(j = 1:200, .combine = "rbind") %dopar% {
dataeg_ssm <- SSModel(dataeg ~ SSMtrend(1, Q=list(j*0.1)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=i*0.1)
dataeg_kfs <- KFS(dataeg_ssm)
l <- loss5(dataeg_x11, dataeg_kfs)
c(i*0.1, j*0.1, l)
}
stopCluster(cl)
})
system.time({
cl <- detectCores()
cl <- makeCluster(cl)
registerDoParallel(cl)
clusterExport(cl, c("loss5"))
lossmat5  <- foreach (i = 1:200, .combine = "rbind", .packages = c("KFAS","seasonal")) %:%
foreach(j = 1:200, .combine = "rbind") %dopar% {
dataeg_ssm <- SSModel(dataeg ~ SSMtrend(1, Q=list(j*0.1)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=i*0.1)
dataeg_kfs <- KFS(dataeg_ssm)
l <- loss5(dataeg_x11, dataeg_kfs)
c(i*0.1, j*0.1, l)
}
stopCluster(cl)
})
lossmat5[which.min(lossmat5[,3]),]
dataeg_ssm5 <- SSModel(dataeg ~ SSMtrend(1, Q=list(2)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=7.8)
dataeg_kfs5 <- KFS(dataeg_ssm5)
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-5,40), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-5,40), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-5,40), ylab='',col=4, lwd=2)
legend(x=2010, y=0,c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-5,40), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-5,40), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-5,40), ylab='', col=4, lwd=2)
legend(x=110, y=0, c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-5,40), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-5,40), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-5,40), ylab='',col=4, lwd=2)
legend('topleft',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-5,40), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-5,40), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-5,40), ylab='', col=4, lwd=2)
legend('topleft', c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
# check other data
dataeg <- simlist[[213]]
dataeg_x11 <- seas(dataeg, x11='')
dataeg_ssm0 <- SSModel(dataeg ~ SSMtrend(1, Q=list(NA)) + SSMseasonal(12, sea.type = 'dummy', Q=NA), H=NA)
dataeg_fit0 <- fitSSM(dataeg_ssm0, inits = c(1,1,1))
dataeg_kfs0 <- KFS(dataeg_fit0$model)
plot(series(dataeg_x11, "d12"), ylab='', lwd=2)
plot(series(dataeg_x11, "d12"),ylim=c(-25,50), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-25,50), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-25,50), ylab='',col=4, lwd=2)
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-25,50), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal[-180],type='l', ylim=c(-25,50), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-25,50), ylab='', col=4, lwd=2)
library(doParallel)
system.time({
cl <- detectCores()
cl <- makeCluster(cl)
registerDoParallel(cl)
clusterExport(cl, c("loss5"))
lossmat5  <- foreach (i = 1:200, .combine = "rbind", .packages = c("KFAS","seasonal")) %:%
foreach(j = 1:200, .combine = "rbind") %dopar% {
dataeg_ssm <- SSModel(dataeg ~ SSMtrend(1, Q=list(j*0.1)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=i*0.1)
dataeg_kfs <- KFS(dataeg_ssm)
l <- loss5(dataeg_x11, dataeg_kfs)
c(i*0.1, j*0.1, l)
}
stopCluster(cl)
})
lossmat5[which.min(lossmat5[,3]),]
dataeg_ssm5 <- SSModel(dataeg ~ SSMtrend(1, Q=list(2)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=7.9)
dataeg_kfs5 <- KFS(dataeg_ssm5)
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-25,50), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-25,50), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-25,50), ylab='',col=4, lwd=2)
legend('topleft',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-25,50), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,50), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-25,50), ylab='', col=4, lwd=2)
legend('topleft', c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
dataeg <- simlist[[521]]
dataeg_x11 <- seas(dataeg, x11='')
dataeg_ssm0 <- SSModel(dataeg ~ SSMtrend(1, Q=list(NA)) + SSMseasonal(12, sea.type = 'dummy', Q=NA), H=NA)
dataeg_fit0 <- fitSSM(dataeg_ssm0, inits = c(1,1,1))
dataeg_kfs0 <- KFS(dataeg_fit0$model)
plot(series(dataeg_x11, "d12"),ylim=c(-25,50), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-25,50), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-25,50), ylab='',col=4, lwd=2)
library(seasonal)
library(KFAS)
# check other data
dataeg <- simlist[[521]]
dataeg_x11 <- seas(dataeg, x11='')
dataeg_ssm0 <- SSModel(dataeg ~ SSMtrend(1, Q=list(NA)) + SSMseasonal(12, sea.type = 'dummy', Q=NA), H=NA)
dataeg_fit0 <- fitSSM(dataeg_ssm0, inits = c(1,1,1))
dataeg_kfs0 <- KFS(dataeg_fit0$model)
plot(series(dataeg_x11, "d12"),ylim=c(-25,50), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-25,50), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-25,50), ylab='',col=4, lwd=2)
plot(series(dataeg_x11, "d12"),ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-25,25), ylab='',col=4, lwd=2)
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-25,25), ylab='', col=4, lwd=2)
library(doParallel)
system.time({
cl <- detectCores()
cl <- makeCluster(cl)
registerDoParallel(cl)
clusterExport(cl, c("loss5"))
lossmat5  <- foreach (i = 1:200, .combine = "rbind", .packages = c("KFAS","seasonal")) %:%
foreach(j = 1:200, .combine = "rbind") %dopar% {
dataeg_ssm <- SSModel(dataeg ~ SSMtrend(1, Q=list(j*0.1)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=i*0.1)
dataeg_kfs <- KFS(dataeg_ssm)
l <- loss5(dataeg_x11, dataeg_kfs)
c(i*0.1, j*0.1, l)
}
stopCluster(cl)
})
lossmat5[which.min(lossmat5[,3]),]
dataeg_ssm5 <- SSModel(dataeg ~ SSMtrend(1, Q=list(1.4)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=4.6)
dataeg_kfs5 <- KFS(dataeg_ssm5)
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-25,25), ylab='',col=4, lwd=2)
legend('topleft',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-25,25), ylab='', col=4, lwd=2)
legend('topleft', c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
？signal
signal
?signal
library(KFAS)
library(seasonal)
？library
?signal
View(loss5)
dataeg_ssm0 <- SSModel(dataeg ~ SSMtrend(1, Q=list(NA)) + SSMseasonal(12, sea.type = 'dummy', Q=NA), H=NA)
dataeg_fit0 <- fitSSM(dataeg_ssm0, inits = c(1,1,1))
dataeg_kfs0 <- KFS(dataeg_fit0$model)
plot(series(dataeg_x11, "d12"),ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal, ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend",filtered = TRUE)$signal, ylim=c(-25,25), ylab='',col=4, lwd=2)
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs0, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-25,25), ylab='', col=4, lwd=2)
?ma
??ma
#####################################################################################
library(ma)
#####################################################################################
library(forecast)
?ma
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5))
length(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5))
length(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=5))
plot(series(dataeg_x11, "d12"),ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=5))
plot(series(dataeg_x11, "d12"),ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=5),ylim=c(-25,25), ylab='', lwd=2, col=2)
plot(series(dataeg_x11, "d12")[-180],ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5),ylim=c(-25,25), ylab='', lwd=2, col=2)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5),ylim=c(-25,25), ylab='', lwd=2, col=2)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5),ylim=c(-25,25), ylab='', lwd=2, col=6)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5),ylim=c(-25,25), ylab='', lwd=2, col=2)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], order=5),ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=5)[-1],ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=5)[-1],type='l',ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=3)[-1],type='l',ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=7)[-1],type='l',ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=180)[-1],type='l',ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=100)[-1],type='l',ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(series(dataeg_x11, "d12")[-180],type='l',ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(ma(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal, order=5)[-1],type='l',ylim=c(-25,25), ylab='', lwd=2, col=3)
plot(dataeg - signal(dataeg_kfs5, "trend")$signal - signal(dataeg_kfs5, "seasonal")$signal - residuals(dataeg_kfs5, "recursive"))
plot(dataeg - signal(dataeg_kfs5, "trend", filtered = TRUE)$signal - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal - residuals(dataeg_kfs5, "recursive"))
plot(series(dataeg_x11, "d11"))
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=2)
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=4, ylim=c(-25,25))
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=4, ylim=c(-25,25))
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=4, ylim=c(-25,25))
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
plot(series(dataeg_x11, 'd10'))
plot(series(dataeg_x11, 'd10'), ylim=c(-10,10), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=2, ylim=c(-10,10))
par(new=TRUE)
plot(signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=4, ylim=c(-10,10))
plot(series(dataeg_x11, "d11"), ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal")$signal, ylab='', lwd=2, col=2, ylim=c(-25,25))
par(new=TRUE)
plot(dataeg - signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal, ylab='', lwd=2, col=4, ylim=c(-25,25))
# but apparently the smoothed version is better
par(mfrow=c(1,2))
plot(series(dataeg_x11, "d12"),ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal, ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend",filtered = TRUE)$signal, ylim=c(-25,25), ylab='',col=4, lwd=2)
legend('topleft',c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main="no lag")
plot(series(dataeg_x11, "d12")[-180],type='l', ylim=c(-25,25), ylab='', lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend")$signal[-180],type='l', ylim=c(-25,25), ylab='',col=2, lwd=2)
par(new=TRUE)
plot(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal[-1], type = 'l', ylim=c(-25,25), ylab='', col=4, lwd=2)
legend('topleft', c('x11', 'smoothed', 'unsmoothed'), col=c(1,2,4), lty=1, bty='n')
title(main='lag1')
par(mfrow=c(1,1))
length(signal(dataeg_kfs5, "seasonal", filtered = TRUE)$signal)
length(signal(dataeg_kfs5, "trend", filtered = TRUE)$signal)
rm(list=ls())
y <- 3 sin(5*x) + 5 sin(x) + 7 cos(8*x)
x <- seq(0,20,0.01)
y <- 3 sin(5*x) + 5 sin(x) + 7 cos(8*x)
plot(y, type='l')
y <- 3*sin(5*x) + 5*sin(x) + 7*cos(8*x)
plot(y, type='l')
y <- 3*sin(5*x+3) + 5*sin(x-7) + 7*cos(8*x+9)
plot(y, type='l')
x <- seq(0,20,0.5)
y <- 3*sin(5*x+3) + 5*sin(x-7) + 7*cos(8*x+9)
plot(y, type='l')
x <- seq(0,120,1)
y <- 3*sin(5*x+3) + 5*sin(x-7) + 7*cos(8*x+9)
plot(y, type='l')
x <- seq(0,13,0.01)
y <- 3*sin(5*x+3) + 5*sin(x-7) + 7*cos(8*x+9)
plot(y, type='l')
x <- seq(0,10,0.01)
y <- 3*sin(5*x+3) + 5*sin(x-7) + 7*cos(8*x+9)
y <- 3*sin(5*x+3) + sin(x-7) + 0.5*cos(8*x+9)
plot(y, type='l')
y <- sin(x)
plot(y, type='l')
y <- sin(2x) + 1
plot(y, type='l')
y <- sin(2*x) + 1
plot(y, type='l')
y <- 1 + sin(2*x) +  0.5*cos(2*x)
plot(y, type='l')
y <- 1 + sin(2*x)
plot(y, type='l')
y <- 1 + sin(2*x) +  0.5*cos(2*x+2)
plot(y, type='l')
y <- 1 + sin(2*x) +  5*cos(2*x+2)
plot(y, type='l')
y <- 1 + sin(2*x) +  5*cos(0.5*x)
plot(y, type='l')
plot(y, xlim=c(0,10), type='l')
plot(y,  type='l')
plot(y,x, type='l')
plot(x, ytype='l')
plot(x, y,type='l')
y <- sin(2*x) +  5*cos(0.5*x)
plot(x, y,type='l')
?plot
?cex
??cex
plot(x, y,type='l', cex.axis=2)
plot(x, y,type='l', cex.axis=1.5)
plot(x, y,type='l', cex.axis=1.5, cex.names=1.5)
plot(x, y,type='l', cex.axis=1.5, cex.lab=1.5)
plot(x, y,type='l', cex.axis=1.5, cex.lab=1.5)
rm(list = ls())
setwd('C:/Users/GuoLY/desktop/markdown/2020 Winter/masterthesis/file5')
load('.RData')
library(seasonal)
library(KFAS)
library(doParallel)
library(dplyr)
library(ggplot2)
library(scales)
library(forecast)
load('C:/Users/GuoLY/desktop/markdown/2020 Winter/masterthesis/simlist.RData')
dataeg <- simlist[[1]]
dataeg_x11 <- seas(dataeg, x11='')
dataeg_ssm5 <- SSModel(dataeg ~ SSMtrend(1, Q=list(2.3)) + SSMseasonal(12, sea.type = 'dummy', Q=1), H=7.6)
dataeg_kfs5 <- KFS(dataeg_ssm5)
plot(series(dataeg_x11, 'd10') - signal(dataeg_kfs5, 'seasonal')$signal, ylab='')
abline(h=mean(log(series(dataeg_x11, 'd10')) - signal(dataeg_kfs5, 'seasonal')$signal), col=2)
plot(series(dataeg_x11, 'd10') - signal(dataeg_kfs5, 'seasonal')$signal, ylab='')
abline(h=mean(series(dataeg_x11, 'd10') - signal(dataeg_kfs5, 'seasonal')$signal), col=2)
title(main='Difference Between Seasonal Series')
plot(series(dataeg2_x11, 'd12') - signal(dataeg_kfs5, 'trend')$signal, ylab='')
abline(h=mean(series(dataeg_x11, 'd12') - signal(dataeg_kfs5, 'trend')$signal), col=2)
title(main='Difference Between Trend Series')
plot(series(dataeg_x11, 'd12') - signal(dataeg_kfs5, 'trend')$signal, ylab='')
abline(h=mean(series(dataeg_x11, 'd12') - signal(dataeg_kfs5, 'trend')$signal), col=2)
title(main='Difference Between Trend Series')
plot(series(dataeg_x11, 'd13') - residuals(dataeg_kfs5, 'response'), ylab='')
abline(h=mean(series(dataeg_x11, 'd13') - residuals(dataeg_kfs5, 'response')), col=2)
title(main='Difference Between Irregular Series')
getwd()
save.image()
